// === DATA SOURCE ===
const supabaseData = {
  "id": "project_1758600436188",
  "coverImage": "https://i.ibb.co.com/ZRd8dkL4/7-20250430-202047-0000.png",
  "title": "Teras Masjid Para Duda #1 - Pak Darto dan Surat yang Tak Pernah Terkirim",
  "author": "RaaRion.",
  "genre": "Fiksi",
  "description": "Pak Darto, pensiunan guru Sekolah Dasar adalah sosok bijak, kalem, dan puitis. Namun, siapa sangka masa mudanya penuh kegelisahan cinta dan surat-surat rahasia?\n\nDalam pertemuan rutin di teras masjid bersama Pak Yos dan Pak Arif, ia membuka kisah cintanya, tentang perempuan penjual buku bekas, surat-surat yang ia selipkan diam-diam, dan keberanian yang muncul di bawah hujan pertama mereka.\n\nDi usia senja, kenangan itu tidak hanya menghangatkan masa lalu, tapi juga mengajarkan bahwa cinta tulus tak pernah usang oleh waktu.\n\nâ€œTeras Masjid Para Dudaâ€ adalah novel berseri yang terdiri dari 4 bagian hangat dan menyentuh, dibingkai dari obrolan ringan tiga pria paruh baya dan satu pemuda di teras masjid kampung.\n\nSetiap seri mengangkat kisah cinta masa lalu, kehilangan, dan pelajaran hidup dari sudut pandang para duda. Pak Darto yang puitis, Pak Yos yang dramatis, dan Pak Arif yang religius.\n\nDi antara canda receh, teh hangat, dan lantunan adzan, tersimpan cerita-cerita yang dalam dan tak terduga: surat cinta yang tak pernah terkirim, cinta yang tumbuh di balik setir angkot, hingga doa-doa sunyi untuk cinta yang telah pergi.\n\nNarator muda, yakni \"aku,\" menjadi saksi, pendengar, dan akhirnya, pewaris kisah.\n\nNovel ini tidak hanya menghibur, tapi juga mengajak pembaca merenungi makna cinta sejati dan bagaimana kehilangan bisa menjadi cahaya.\n\nBacaan yang cocok untuk kamu yang rindu cerita sederhana, penuh nilai, dan dekat dengan kehidupan kita sehari-hari.",
  "chapters": [
    {
      "id": "chapter_1",
      "title": "Prolog",
      "status": "completed",
      "content": "<p class=\"mb-4\" style=\"color: rgb(0, 0, 0); font-family: Merriweather; font-size: medium;\">Masjid selalu menjadi tempat yang nyaman untuk berkumpul, meski tak selalu untuk beribadah. Untuk Pak Darto, masjid adalah ruang untuk mencari kedamaian, tempat di mana ia bisa memulai hari-harinya dengan sejenak melepaskan diri dari kegelisahan yang menggerogoti. Di sana, ia bukan hanya sekadar jamaah yang mengikuti shalat, tetapi juga bagian dari sebuah kelompok yang secara tidak sengaja terbentukâ€¦&nbsp;<b>Kelompok Para Duda</b>.</p><p class=\"mb-4\" style=\"color: rgb(0, 0, 0); font-family: Merriweather; font-size: medium;\">Setiap hari, selepas shalat, ia duduk di teras masjid bersama dua orang sahabatnya, Pak Yos dan Pak Arif. Mereka sudah saling mengenal lama, namun kedekatan mereka semakin kuat sejak kehilangan yang sama-sama mereka alami.</p><p class=\"mb-4\" style=\"color: rgb(0, 0, 0); font-family: Merriweather; font-size: medium;\">Tiga pria paruh baya ini, meskipun tak lagi muda, memiliki ikatan yang tak tergoyahkan. Mereka selalu duduk bersama, berbicara tentang hal-hal yang mungkin tak pernah mereka ungkapkan pada orang lain. Tentang hidup, tentang kehilangan, tentang masa depan yang tak lagi secerah dulu.</p><p class=\"mb-4\" style=\"color: rgb(0, 0, 0); font-family: Merriweather; font-size: medium;\">Sudah lima tahun sejak istri Pak Darto berpulang, namun ia masih datang ke masjid setiap hari dengan wajah yang sama, tenang, sedikit murung, dan selalu membawa map lusuh berisi lembaran-lembaran yang tak pernah ia tunjukkan pada siapa pun. Beberapa bilang itu catatan pengajian. Beberapa lagi, termasuk aku, menduga itu adalah surat-surat yang tak pernah ia kirimkan.</p><p class=\"mb-4\" style=\"color: rgb(0, 0, 0); font-family: Merriweather; font-size: medium;\">Pak Darto bukan tipe yang banyak bicara, tapi bukan berarti ia dingin. Ia hanya memilih diam. Diam yang tidak kosong, melainkan penuh perenungan. Di teras masjid itulah ia duduk setiap pagi bersama Pak Yos dan Pak Arif, dua sahabat senasib yang membuat kesunyian terasa lebih ringan.</p><p class=\"mb-4\" style=\"color: rgb(0, 0, 0); font-family: Merriweather; font-size: medium;\">Mereka bertiga bukan komunitas formal, tak punya nama, apalagi agenda. Tapi bagi kami yang sering mengintip dari jauh, mereka seperti penjaga waktu. Tiga pria yang duduk di teras masjid, menyeduh pagi dengan obrolan, tawa, dan kadang, diam yang penuh makna.</p><p class=\"mb-4\" style=\"color: rgb(0, 0, 0); font-family: Merriweather; font-size: medium;\">Aku mengenal mereka setelah kembali ke kampung halaman. Awalnya hanya lewat dan melihat sekilas, karena memang rumahku bersebelahan dengan masjid itu, lalu penasaran, lalu duduk diam-diam tak jauh dari mereka. Dan entah sejak kapan, aku merasa duduk bersama mereka seperti membaca bab-bab kehidupan yang hilang dari hidupku sendiri.</p><p class=\"mb-4\" style=\"color: rgb(0, 0, 0); font-family: Merriweather; font-size: medium;\">Dan semua itu, dimulai dari&nbsp;<b>Pak Darto, dan Surat-surat yang Tak Pernah Terkirim.</b></p><p style=\"color: rgb(0, 0, 0); font-family: Merriweather; font-size: medium;\"><b>***</b></p>",
      "summary": "",
      "createdAt": "2025-09-23T04:08:17.312Z",
      "direction": "ltr",
      "updatedAt": "2025-09-23T04:08:50.246Z",
      "wordCount": 333
    },
    {
      "id": "chapter_2",
      "title": "1 - TTS - Teras, Tawa dan Sore",
      "status": "completed",
      "content": "<p class=\"mb-4\" style=\"color: rgb(0, 0, 0); font-family: Merriweather; font-size: medium; text-align: justify;\">Matahari sore menggantung rendah, menyinari tembok masjid yang mengelupas di beberapa bagian. Suaranya sudah lama tak lantang memanggil seperti dulu, tapi adzan Ashar tadi masih terasa membekas di udara.</p><p class=\"mb-4\" style=\"color: rgb(0, 0, 0); font-family: Merriweather; font-size: medium; text-align: justify;\">Masjid kecil itu, di ujung gang kampung kami, berdiri seperti biasa, tenang, tua, dan hangat. Terasnya sudah lama jadi tempat duduk paling nyaman sehabis salat, tempat segala macam topik bergulir tanpa rencana, mulai dari harga cabe sampai cerita cinta.</p><p class=\"mb-4\" style=\"color: rgb(0, 0, 0); font-family: Merriweather; font-size: medium; text-align: justify;\">Aku datang agak telat sore itu. Biasanya sudah duduk sejak rakaat terakhir, pura-pura khusyuk padahal sekadar ingin dapat angin sejuk dari kipas gantung. Tapi hari itu, langkahku pelan. Rasanya ingin menikmati jalan setapak berubin merah yang mulai aus, seperti mengenang tanah yang sudah akrab dengan jejak kaki sendiri. Dari kejauhan, suara tawa tiga orang itu sudah terdengar.</p><p class=\"mb-4\" style=\"color: rgb(0, 0, 0); font-family: Merriweather; font-size: medium; text-align: justify;\">Tiga lelaki tua, masing-masing dengan gaya khas, duduk di tempat yang sudah jadi semacam markas tetap mereka. Teras masjid ini sempit, tapi entah bagaimana selalu cukup untuk mereka bertiga, ditambah aku yang kadang datang, kadang hanya menumpang dengar.</p><p class=\"mb-4\" style=\"color: rgb(0, 0, 0); font-family: Merriweather; font-size: medium; text-align: justify;\">â€œLah, itu dia, anak muda kesayangan Pak Arif!â€ seru Pak Yos sambil menyipitkan mata ke arahku.</p><p class=\"mb-4\" style=\"color: rgb(0, 0, 0); font-family: Merriweather; font-size: medium; text-align: justify;\">â€œDuduk, duduk. Takutnya dunia ini terlalu serius kalau nggak ada kamu yang suka manggut-manggut padahal bingung.â€</p><p class=\"mb-4\" style=\"color: rgb(0, 0, 0); font-family: Merriweather; font-size: medium; text-align: justify;\">Aku terkekeh, menyalami ketiganya satu per satu sebelum duduk di sisi paling ujung. Posisi aman buat jadi pendengar, dan kalau perlu, bisa pura-pura sibuk lihat HP.</p><p class=\"mb-4\" style=\"color: rgb(0, 0, 0); font-family: Merriweather; font-size: medium; text-align: justify;\">Pak Arif tersenyum tipis. \"Assalamualaikum, Mas.\" Suaranya tenang seperti biasanya. Ia baru selesai menyapu halaman masjid, mukanya masih berkeringat.</p><p class=\"mb-4\" style=\"color: rgb(0, 0, 0); font-family: Merriweather; font-size: medium; text-align: justify;\">Pak Darto menyambutku dengan anggukan, tangan kirinya memegang cangkir teh yang sudah tinggal setengah. Ia mengenakan sarung kotak-kotak dan baju koko warna gading yang sudah agak kusam tapi tetap rapi. Ia memang tipe orang yang bisa duduk diam tanpa terlihat kosong.</p><p class=\"mb-4\" style=\"color: rgb(0, 0, 0); font-family: Merriweather; font-size: medium; text-align: justify;\">\"Waalaikumsalam, Pak Arif, semuanya,\" jawabku, sambil menarik napas. Udara sore itu wangi daun ketapang dan tanah yang baru disiram.</p><p class=\"mb-4\" style=\"color: rgb(0, 0, 0); font-family: Merriweather; font-size: medium; text-align: justify;\">â€œLho, tadi ngaji nggak?â€ tanya Pak Yos, pura-pura serius. â€œKalau nggak ngaji, jangan ikut duduk. Ini area eksklusif alumni pengajian.â€</p><p class=\"mb-4\" style=\"color: rgb(0, 0, 0); font-family: Merriweather; font-size: medium; text-align: justify;\">Aku nyengir. â€œKalau alumni-nya kayak Bapak, ngaji-nya isinya gosip Pak RW terus kayaknya.â€</p><p class=\"mb-4\" style=\"color: rgb(0, 0, 0); font-family: Merriweather; font-size: medium; text-align: justify;\">Pak Arif tertawa kecil. â€œItu bagian dari menjaga ukhuwah, Mas.â€</p><p class=\"mb-4\" style=\"color: rgb(0, 0, 0); font-family: Merriweather; font-size: medium; text-align: justify;\">â€œUkhuwah pala kamu!â€ balas Pak Yos. â€œYang kamu jaga itu rasa penasaran!â€</p><p class=\"mb-4\" style=\"color: rgb(0, 0, 0); font-family: Merriweather; font-size: medium; text-align: justify;\">Tawa mereka pecah. Aku hanya menggelengkan kepala. Obrolan mereka selalu seperti ini, setengah serius, setengah main-main. Tapi di balik banyolan itu, ada kehangatan yang tak bisa dibuat-buat. Seolah sore di teras ini bukan hanya tempat berkumpul, tapi semacam ritual sunyi yang menyambung hidup.</p><p class=\"mb-4\" style=\"color: rgb(0, 0, 0); font-family: Merriweather; font-size: medium; text-align: justify;\">Dari kejauhan, terdengar suara sepeda lewat, anak kecil mengejar-ngejar layangan, dan ibu-ibu mengobrol sambil menyiram tanaman. Masjid ini memang bukan masjid besar, tapi jadi poros bagi kehidupan kecil yang tenang.</p><p class=\"mb-4\" style=\"color: rgb(0, 0, 0); font-family: Merriweather; font-size: medium; text-align: justify;\">Pak Arif duduk bersila, mengelap keringatnya dengan ujung sarung.</p><p class=\"mb-4\" style=\"color: rgb(0, 0, 0); font-family: Merriweather; font-size: medium; text-align: justify;\">â€œSore gini paling enak emang minum teh, ya,â€ gumamnya.</p><p class=\"mb-4\" style=\"color: rgb(0, 0, 0); font-family: Merriweather; font-size: medium; text-align: justify;\">â€œKalau teh-nya manis. Kalau pahit, namanya bukan teh sore, tapi pelajaran hidup,â€ kata Pak Darto, tanpa ekspresi.</p><p class=\"mb-4\" style=\"color: rgb(0, 0, 0); font-family: Merriweather; font-size: medium; text-align: justify;\">Aku meliriknya. â€œPak Darto lagi filosofis, nih.â€</p><p class=\"mb-4\" style=\"color: rgb(0, 0, 0); font-family: Merriweather; font-size: medium; text-align: justify;\">â€œLho, aku memang selalu begitu,â€ katanya santai. â€œTapi kalian terlalu sibuk tertawa buat sadar.â€</p><p class=\"mb-4\" style=\"color: rgb(0, 0, 0); font-family: Merriweather; font-size: medium; text-align: justify;\">Pak Yos mengangkat tangan. â€œNah, ini dia. Waktunya sesi puitis sore hari!â€</p><p class=\"mb-4\" style=\"color: rgb(0, 0, 0); font-family: Merriweather; font-size: medium; text-align: justify;\">â€œDuh, mulai lagi,â€ celetuk Pak Arif, pura-pura menutup telinga.</p><p class=\"mb-4\" style=\"color: rgb(0, 0, 0); font-family: Merriweather; font-size: medium; text-align: justify;\">Pak Yos menoleh ke arahku. â€œDengar ya, Nak. Ini Pak Darto, dulu julukannya Penyair Kampung. Tiap minggu pasti ada puisi cinta yang dikliping di majalah dinding SD tempat dia ngajar. Padahal, murid-muridnya masih bingung bedain antara pantun dan peribahasa.â€</p><p class=\"mb-4\" style=\"color: rgb(0, 0, 0); font-family: Merriweather; font-size: medium; text-align: justify;\">â€œLha, aku ngajar SD, bukan fakultas sastra,â€ kata Pak Darto, tersenyum kecil.</p><p class=\"mb-4\" style=\"color: rgb(0, 0, 0); font-family: Merriweather; font-size: medium; text-align: justify;\">Aku tertawa. â€œJadi benar dulu Pak Darto rajin nulis puisi?â€</p><p class=\"mb-4\" style=\"color: rgb(0, 0, 0); font-family: Merriweather; font-size: medium; text-align: justify;\">â€œRajin nulis, malas ngasih,â€ katanya pelan. â€œSurat cinta pun ditulis, tapi nggak pernah dikirim.â€</p><p class=\"mb-4\" style=\"color: rgb(0, 0, 0); font-family: Merriweather; font-size: medium; text-align: justify;\">Pak Yos langsung membelalak. â€œNah ini! Aku sudah bilang dari dulu, anak ini harus tahu kisah legendaris itu, Dar! Iya nggak, Rif?â€</p><p class=\"mb-4\" style=\"color: rgb(0, 0, 0); font-family: Merriweather; font-size: medium; text-align: justify;\">Pak Arif hanya mengangguk sambil tersenyum tipis.</p><p class=\"mb-4\" style=\"color: rgb(0, 0, 0); font-family: Merriweather; font-size: medium; text-align: justify;\">â€œSurat cinta yang nggak pernah dikirim?â€ ulangku, mulai tertarik.</p><p class=\"mb-4\" style=\"color: rgb(0, 0, 0); font-family: Merriweather; font-size: medium; text-align: justify;\">Pak Darto menatap ke ujung halaman masjid, seperti melihat ke tempat yang tak kasat mata. â€œIya. Banyak surat. Ratusan mungkin. Tapi aku cuma selipkan satu-dua di antara buku bekas.â€</p><p class=\"mb-4\" style=\"color: rgb(0, 0, 0); font-family: Merriweather; font-size: medium; text-align: justify;\">â€œAduh, mulai deh nostalgia,â€ goda Pak Arif.</p><p class=\"mb-4\" style=\"color: rgb(0, 0, 0); font-family: Merriweather; font-size: medium; text-align: justify;\">Tapi suasana mendadak berubah sedikit. Masih hangat, tapi jadi lebih dalam. Pak Darto menyesap teh-nya pelan, lalu berkata, â€œJangan remehkan puisi cinta, Yos. Gara-gara itu aku nikah.â€</p><p class=\"mb-4\" style=\"color: rgb(0, 0, 0); font-family: Merriweather; font-size: medium; text-align: justify;\">Diam sejenak.</p><p class=\"mb-4\" style=\"color: rgb(0, 0, 0); font-family: Merriweather; font-size: medium; text-align: justify;\">Pak Yos tidak lagi bercanda. Ia hanya mengangguk pelan.</p><p class=\"mb-4\" style=\"color: rgb(0, 0, 0); font-family: Merriweather; font-size: medium; text-align: justify;\">Aku bersandar ke tiang teras. Matahari mulai turun lebih rendah, menyinari ujung sarung kami. Di luar, anak-anak masih berlarian. Tapi di dalam sini, waktu seperti berjalan lambat.</p><p class=\"mb-4\" style=\"color: rgb(0, 0, 0); font-family: Merriweather; font-size: medium; text-align: justify;\">Hari itu, aku merasa sedang duduk di antara tiga lembar hidup yang nyaris selesai, tapi belum sepenuhnya ditutup. Danâ€¦ sepertinya kali ini, aku ingin benar-benar membaca setiap barisnya.</p><p style=\"color: rgb(0, 0, 0); font-family: Merriweather; font-size: medium;\"><s>Î¿Î¿Î¿</s></p>",
      "summary": "",
      "createdAt": "2025-09-23T04:09:24.611Z",
      "direction": "ltr",
      "updatedAt": "2025-09-23T04:10:03.934Z",
      "wordCount": 2337
    },
    {
      "id": "chapter_3",
      "title": "2 - Masa-masa Surat Cinta Berjalan Kaki",
      "status": "completed",
      "content": "<p class=\"mb-4\" style=\"color: rgb(0, 0, 0); font-family: Merriweather; font-size: medium;\">â€œDarto, kamu tuh naksir atau lagi penelitian?â€ tanya Pak Yos sambil menyeruput teh yang sudah mulai dingin.</p><p class=\"mb-4\" style=\"color: rgb(0, 0, 0); font-family: Merriweather; font-size: medium;\">Pak Darto tersenyum tipis. â€œNaksir. Tapi aku butuh data dulu sebelum nyatakan perasaan.â€</p><p class=\"mb-4\" style=\"color: rgb(0, 0, 0); font-family: Merriweather; font-size: medium;\">Tawa meledak. Bahkan Pak Arif yang biasanya hemat kata ikut menepuk lutut. â€œPantesan kamu lama jomblonya.â€</p><p class=\"mb-4\" style=\"color: rgb(0, 0, 0); font-family: Merriweather; font-size: medium;\">Aku duduk bersandar di tiang teras masjid, sambil melepas kancing lengan baju yang basah keringat. Angin sore menghembus pelan, membawa aroma tanah yang mulai mengering setelah hujan siang tadi.</p><p class=\"mb-4\" style=\"color: rgb(0, 0, 0); font-family: Merriweather; font-size: medium;\">Pak Darto melanjutkan tanpa menunggu diminta. â€œWaktu itu tahun 1978. Aku baru dua bulan jadi guru SD, tinggal di rumah kontrakan satu kamar, dan belum punya sepeda. Tiap pagi jalan kaki, dan tiap soreâ€¦ juga jalan kaki.â€</p><p class=\"mb-4\" style=\"color: rgb(0, 0, 0); font-family: Merriweather; font-size: medium;\">â€œTapi masih kuat kan larinya?â€ sela Pak Yos.</p><p class=\"mb-4\" style=\"color: rgb(0, 0, 0); font-family: Merriweather; font-size: medium;\">â€œDulu kuat. Sekarang lari ke kamar mandi aja ngos-ngosan,â€ jawabnya sambil tertawa.</p><p class=\"mb-4\" style=\"color: rgb(0, 0, 0); font-family: Merriweather; font-size: medium;\">Lalu ia diam sebentar, menghela napas panjang, dan tiba-tiba kami semua tahu, ia sedang membuka pintu kenangan yang jarang disentuh.</p><p class=\"mb-4\" style=\"color: rgb(0, 0, 0); font-family: Merriweather; font-size: medium;\">***</p><br style=\"color: rgb(0, 0, 0); font-family: Merriweather; font-size: medium;\"><p class=\"mb-4\" style=\"color: rgb(0, 0, 0); font-family: Merriweather; font-size: medium;\">Darto muda melangkah pelan di gang sempit pasar sore itu. Rambutnya disisir ke samping, kemeja putih tipisnya digulung sampai siku, dan sepatu hitamnya, warisan dari ayahnya itu masih sedikit mengkilap. Di tangan kirinya tergenggam sebuah buku lusuh yang sudah ia baca tiga kali, hanya untuk terlihat â€œberwawasanâ€ saat mampir ke lapak buku bekas.</p><p class=\"mb-4\" style=\"color: rgb(0, 0, 0); font-family: Merriweather; font-size: medium;\">Lapak itu terletak di tikungan kecil antara tukang sate dan penjual jamu gendong. Di atas terpal biru yang sudah mulai robek-robek, tumpukan buku-buku bekas tertata rapi. Pemiliknya seorang gadis muda. Tidak terlalu mencolok, tapi justru itu yang menarik perhatian Darto. Ia duduk di bangku kayu pendek, mengenakan blus sederhana dan jilbab panjang warna coklat. Jemarinya cekatan membolak-balik halaman, sesekali meniup debu dari sudut buku.</p><p class=\"mb-4\" style=\"color: rgb(0, 0, 0); font-family: Merriweather; font-size: medium;\">Darto berhenti di depan lapak, pura-pura tertarik dengan satu buku puisi. Ia membalik-balik halaman, padahal pikirannya sepenuhnya tertuju pada senyum tipis sang penjaga lapak.</p><p class=\"mb-4\" style=\"color: rgb(0, 0, 0); font-family: Merriweather; font-size: medium;\">â€œIni berapa, Mbak?â€ tanyanya pelan.</p><p class=\"mb-4\" style=\"color: rgb(0, 0, 0); font-family: Merriweather; font-size: medium;\">â€œLima ratus, Pak,â€ jawabnya. Suaranya pelan tapi jelas. Tidak menunduk, tidak juga menatap langsung, tapi cukup untuk membuat dada Darto berdebar lebih cepat dari biasanya.</p><p class=\"mb-4\" style=\"color: rgb(0, 0, 0); font-family: Merriweather; font-size: medium;\">Ia membuka halaman tengah buku itu, bukan karena isinya, tapi karena di sanalah ia akan menyelipkan sesuatu kelak.</p><p class=\"mb-4\" style=\"color: rgb(0, 0, 0); font-family: Merriweather; font-size: medium;\">â€œKayaknyaâ€¦ nggak jadi, deh,â€ katanya cepat. â€œSaya cari yang lain dulu.â€</p><p class=\"mb-4\" style=\"color: rgb(0, 0, 0); font-family: Merriweather; font-size: medium;\">â€œSilakan, Pak.â€</p><p class=\"mb-4\" style=\"color: rgb(0, 0, 0); font-family: Merriweather; font-size: medium;\">Dan begitulah berulang-ulang. Hari-hari berikutnya, Darto datang dengan buku lain. Kadang ia beli, kadang hanya lihat-lihat. Tapi sejak kunjungan ketiga lalu, ia mulai menulis surat. Bukan surat pengakuan cinta. Hanya satu-dua paragraf berisi celotehan ringan.</p>",
      "summary": "",
      "createdAt": "2025-09-23T04:10:39.214Z",
      "direction": "ltr",
      "updatedAt": "2025-10-04T06:08:59.233Z",
      "wordCount": 2822
    }
  ],
  "created_at": "2025-12-27T13:36:39.763+00:00",
  "updated_at": "2025-12-27T13:36:39.763+00:00"
};

// === APP STATE & UTILS ===
let reviews = [
    { name: "Andini", rating: 5, comment: "Ceritanya sangat hangat, bikin kangen suasana kampung halaman.", date: "2 jam yang lalu" },
    { name: "Budi_01", rating: 4, comment: "Karakter Pak Darto sangat kuat. Puitis tapi tidak lebay.", date: "1 hari yang lalu" },
    { name: "Sari_P", rating: 5, comment: "Membaca cerita ini seperti minum teh hangat di sore hari. Sangat menyentuh!", date: "3 hari yang lalu" }
];

let selectedRating = 0;
let isSynopsisExpanded = false;
let navClickListener = null;
let pwaInstaller = null;

// === TOAST SYSTEM ===
const toast = {
    show: (message, type = 'info') => {
        const container = document.getElementById('toast-container');
        // Remove all existing toasts
        container.innerHTML = '';
        
        const el = document.createElement('div');
        el.className = 'toast';
        el.setAttribute('role', 'alert');
        el.setAttribute('aria-live', 'polite');
        
        let icon = '';
        switch(type) {
            case 'success': icon = '<i class="ph-fill ph-check-circle text-green-400 text-lg"></i>'; break;
            case 'error': icon = '<i class="ph-fill ph-warning-circle text-red-400 text-lg"></i>'; break;
            default: icon = '<i class="ph-fill ph-info text-blue-400 text-lg"></i>';
        }
        
        el.innerHTML = `${icon} <span>${message}</span>`;
        container.appendChild(el);
        
        setTimeout(() => {
            el.style.opacity = '0';
            el.style.transform = 'translateY(-20px)';
            setTimeout(() => el.remove(), 300);
        }, 3000);
        
        el.onclick = () => el.remove();
    },
    clearAll: () => document.getElementById('toast-container').innerHTML = ''
};

// === ROUTER ===
const router = {
    backToHome: () => {
        // Aman: arahkan ke root repo, bukan history.back()
        window.location.href = '../../'; 
    }
};

// === UI CONTROLLER ===
const ui = {
    init: () => {
        document.getElementById('cover-title').innerText = supabaseData.title.split('#')[0].trim();
        document.getElementById('cover-author').innerText = supabaseData.author;
        document.getElementById('detail-title').innerText = supabaseData.title;
        document.getElementById('detail-author').innerText = supabaseData.author;
        
        const desc = document.getElementById('detail-desc');
        desc.innerText = supabaseData.description;
        document.getElementById('chapter-count').innerText = `${supabaseData.chapters.length} Chapters`;

        const list = document.getElementById('chapter-list');
        list.innerHTML = ''; // Clear first
        supabaseData.chapters.forEach((ch, i) => {
            const el = document.createElement('div');
            el.className = "flex items-center justify-between p-4 bg-white dark:bg-brand-paperDark rounded-2xl border border-gray-100 dark:border-white/5 shadow-sm cursor-pointer active:scale-[0.98] transition-all duration-200 group hover:border-brand-slate/20";
            el.onclick = () => reader.open(i);
            el.innerHTML = `
                <div class="flex items-center gap-4">
                    <div class="w-8 h-8 rounded-full bg-brand-bg dark:bg-white/5 flex items-center justify-center text-brand-slate dark:text-brand-slateLight font-bold text-xs group-hover:bg-brand-slate group-hover:text-white transition-colors">
                        ${i+1}
                    </div>
                    <div class="flex flex-col">
                        <span class="font-serif font-bold text-sm text-brand-text dark:text-white leading-tight">${ch.title}</span>
                        <span class="text-[10px] text-gray-400 mt-0.5">${ch.wordCount} kata</span>
                    </div>
                </div>
                <i class="ph ph-caret-right text-gray-300 dark:text-gray-600 group-hover:text-brand-slate transition-colors"></i>
            `;
            list.appendChild(el);
        });

        ui.renderReviews();
        ui.initStarInput();
        ui.loadTheme();
        ui.bindEvents();
    },

    bindEvents: () => {
        // Synopsis Toggle
        document.getElementById('btn-synopsis').onclick = ui.toggleSynopsis;
        
        // Theme Toggles
        document.getElementById('theme-toggle-btn').onclick = ui.toggleTheme;
        document.getElementById('nav-theme-btn').onclick = ui.toggleTheme;
        
        // Navigation
        document.getElementById('nav-toggle-btn').onclick = toggleNav;
        
        // Search
        document.getElementById('search-toggle').onclick = search.show;
        document.getElementById('search-close-btn').onclick = search.hide;
        document.getElementById('search-backdrop').onclick = search.hide;
        document.getElementById('search-input').oninput = (e) => search.perform(e.target.value);

        // Reader Actions
        document.getElementById('start-reading-btn').onclick = () => reader.open(0);
        document.getElementById('start-fab-btn').onclick = () => reader.open(0);
        document.getElementById('btn-bookmark').onclick = ui.bookmark;
        
        // Share
        document.getElementById('share-btn').onclick = enhancedShare.shareBook;

        // Reviews
        document.getElementById('open-review-btn').onclick = ui.openReviewModal;
        document.getElementById('close-review-btn').onclick = ui.closeReviewModal;
        document.getElementById('review-backdrop').onclick = ui.closeReviewModal;
        document.getElementById('submit-review-btn').onclick = ui.submitReview;

        // Reader UI
        document.getElementById('reader-back-btn').onclick = reader.back;
        document.getElementById('reader-settings-btn').onclick = reader.toggleSettings;
        document.getElementById('close-settings-btn').onclick = reader.toggleSettings;
        document.getElementById('btn-prev').onclick = () => reader.nav(-1);
        document.getElementById('btn-next').onclick = () => reader.nav(1);
        document.getElementById('reader-progress-container').onclick = reader.jumpToProgress;
        document.getElementById('reader-scroll').onclick = reader.toggleUI;
    },

    loadTheme: () => {
        const isDark = localStorage.getItem('theme') === 'dark';
        if(isDark) document.body.classList.add('dark-mode');
        ui.updateThemeIcons(isDark);
    },

    toggleTheme: () => {
        document.body.classList.toggle('dark-mode');
        const isDark = document.body.classList.contains('dark-mode');
        localStorage.setItem('theme', isDark ? 'dark' : 'light');
        ui.updateThemeIcons(isDark);
        toast.show(isDark ? "Mode Gelap Aktif" : "Mode Terang Aktif");
    },

    updateThemeIcons: (isDark) => {
        const icon = document.getElementById('theme-icon');
        const navIcon = document.getElementById('nav-theme-icon');
        if(isDark) {
            icon.className = 'ph-fill ph-sun text-lg text-yellow-400';
            navIcon.className = 'ph-fill ph-sun text-lg text-yellow-400';
        } else {
            icon.className = 'ph ph-moon text-lg';
            navIcon.className = 'ph ph-moon text-lg';
        }
    },

    toggleSynopsis: () => {
        const desc = document.getElementById('detail-desc');
        const btn = document.getElementById('btn-synopsis');
        isSynopsisExpanded = !isSynopsisExpanded;
        
        if(isSynopsisExpanded) {
            desc.classList.remove('line-clamp-3');
            btn.innerHTML = `Tutup <i class="ph-bold ph-caret-up"></i>`;
        } else {
            desc.classList.add('line-clamp-3');
            btn.innerHTML = `Baca Selengkapnya <i class="ph-bold ph-caret-down"></i>`;
            desc.scrollIntoView({ behavior: 'smooth', block: 'center' });
        }
    },

    renderReviews: () => {
        const container = document.getElementById('reviews-container');
        if (reviews.length === 0) {
            container.innerHTML = '<p class="text-center text-xs text-gray-400 py-6 bg-gray-50 dark:bg-white/5 rounded-2xl border border-dashed border-gray-200 dark:border-white/10">Belum ada ulasan.</p>';
        } else {
            container.innerHTML = reviews.map(r => `
                <div class="bg-white dark:bg-brand-paperDark p-4 rounded-2xl shadow-sm border border-gray-100 dark:border-white/5 flex gap-3 transition-colors">
                    <div class="w-8 h-8 rounded-full bg-brand-slate/10 dark:bg-white/10 text-brand-slate dark:text-brand-slateLight flex-shrink-0 flex items-center justify-center text-[10px] font-bold border border-brand-slate/10 dark:border-white/5">
                        ${r.name ? r.name[0].toUpperCase() : '?'}
                    </div>
                    <div class="flex-1">
                        <div class="flex justify-between items-center mb-1">
                            <h5 class="text-xs font-bold text-brand-text dark:text-white">${r.name || 'Anonim'}</h5>
                            <div class="flex text-[10px] text-amber-400">${'â˜…'.repeat(r.rating)}${'â˜†'.repeat(5-r.rating)}</div>
                        </div>
                        <p class="text-xs text-gray-500 dark:text-gray-400 leading-relaxed font-book">"${r.comment}"</p>
                    </div>
                </div>
            `).join('');
        }
        
        if (reviews.length > 0) {
            const avg = (reviews.reduce((a,b) => a + b.rating, 0) / reviews.length).toFixed(1);
            document.getElementById('avg-rating').innerText = avg;
        }
    },

    initStarInput: () => {
        const container = document.getElementById('star-input');
        container.innerHTML = '';
        for(let i=1; i<=5; i++) {
            const star = document.createElement('i');
            star.className = `ph-fill ph-star text-2xl text-gray-200 dark:text-gray-600 cursor-pointer transition-colors duration-200 hover:text-amber-300`;
            star.dataset.v = i;
            star.onclick = () => {
                selectedRating = i;
                ui.updateStarDisplay();
            };
            container.appendChild(star);
        }
    },

    updateStarDisplay: () => {
        const stars = document.querySelectorAll('#star-input i');
        stars.forEach((star, i) => {
            if(i < selectedRating) {
                star.classList.remove('text-gray-200', 'dark:text-gray-600');
                star.classList.add('text-amber-400');
            } else {
                star.classList.add('text-gray-200', 'dark:text-gray-600');
                star.classList.remove('text-amber-400');
            }
        });
    },

    openReviewModal: () => {
        const modal = document.getElementById('modal-review');
        const content = document.getElementById('modal-content');
        modal.classList.remove('hidden');
        setTimeout(() => {
            modal.classList.remove('opacity-0');
            content.classList.remove('translate-y-full');
        }, 10);
    },

    closeReviewModal: () => {
        const modal = document.getElementById('modal-review');
        const content = document.getElementById('modal-content');
        modal.classList.add('opacity-0');
        content.classList.add('translate-y-full');
        setTimeout(() => modal.classList.add('hidden'), 300);
    },

    submitReview: () => {
        const name = document.getElementById('input-name').value.trim();
        const comment = document.getElementById('input-comment').value.trim();
        
        if(selectedRating === 0) { toast.show("Berikan rating bintang dulu ya!", "error"); return; }
        if(!comment) { toast.show("Ulasan tidak boleh kosong.", "error"); return; }

        const newReview = { name: name || "Sahabat Kisah", rating: selectedRating, comment: comment, date: "Baru saja" };
        reviews.unshift(newReview);
        ui.renderReviews();
        ui.closeReviewModal();
        
        document.getElementById('input-name').value = '';
        document.getElementById('input-comment').value = '';
        selectedRating = 0;
        ui.updateStarDisplay();
        
        toast.show("Terima kasih atas ulasan Anda!", "success");
    },

    bookmark: () => {
        const icon = document.getElementById('icon-bookmark');
        if(icon.classList.contains('ph-bookmark-simple')) {
            icon.classList.replace('ph-bookmark-simple', 'ph-bookmark-simple-fill');
            icon.classList.add('text-yellow-500');
            toast.show("Buku ini ditandai", "success");
        } else {
            icon.classList.replace('ph-bookmark-simple-fill', 'ph-bookmark-simple');
            icon.classList.remove('text-yellow-500');
            toast.show("Tanda buku dihapus");
        }
    }
};

// === READER CONTROLLER ===
const reader = {
    idx: 0,
    isUIHidden: false,
    
    open: (i) => {
        reader.idx = i;
        reader.render();
        const view = document.getElementById('view-reader');
        view.classList.remove('hidden');
        void view.offsetWidth; 
        view.classList.remove('translate-y-full');
        document.body.style.overflow = 'hidden';
    },
    
    back: () => {
        const view = document.getElementById('view-reader');
        view.classList.add('translate-y-full');
        setTimeout(() => {
            view.classList.add('hidden');
            document.body.style.overflow = '';
        }, 300);
    },
    
    render: () => {
        const ch = supabaseData.chapters[reader.idx];
        document.getElementById('reader-title').innerText = ch.title;
        document.getElementById('reader-nav-title').innerText = `BAB ${reader.idx + 1}`;
        
        const readerBody = document.getElementById('reader-body');
        readerBody.innerHTML = ch.content;
        
        document.getElementById('btn-prev').disabled = reader.idx === 0;
        document.getElementById('btn-next').disabled = reader.idx === supabaseData.chapters.length - 1;
        reader.updateProgress();
        document.getElementById('reader-scroll').scrollTop = 0;
    },
    
    nav: (d) => { 
        if (reader.idx + d >= 0 && reader.idx + d < supabaseData.chapters.length) {
            reader.idx += d; 
            reader.render();
        }
    },

    updateProgress: () => {
        const pct = ((reader.idx+1)/supabaseData.chapters.length)*100;
        document.getElementById('progress-bar').style.width = `${pct}%`;
        document.getElementById('mini-progress').style.width = `${pct}%`;
    },

    jumpToProgress: (e) => {
        const rect = e.currentTarget.getBoundingClientRect();
        const x = e.clientX - rect.left;
        const pct = x / rect.width;
        const targetIdx = Math.floor(pct * supabaseData.chapters.length);
        if(targetIdx >= 0 && targetIdx < supabaseData.chapters.length) {
            reader.idx = targetIdx;
            reader.render();
        }
    },

    toggleUI: () => {
        reader.isUIHidden = !reader.isUIHidden;
        const top = document.getElementById('reader-top');
        const bottom = document.getElementById('reader-bottom');
        if(reader.isUIHidden) {
            top.classList.add('reader-hidden');
            bottom.classList.add('reader-hidden');
        } else {
            top.classList.remove('reader-hidden');
            bottom.classList.remove('reader-hidden');
        }
    },
    
    toggleSettings: () => {
        const panel = document.getElementById('settings-panel');
        if(panel.classList.contains('hidden')) {
            panel.classList.remove('hidden');
            setTimeout(() => {
                panel.classList.remove('opacity-0', 'translate-y-4');
            }, 10);
        } else {
            panel.classList.add('opacity-0', 'translate-y-4');
            setTimeout(() => panel.classList.add('hidden'), 300);
        }
    }
};

// === NAVIGATION MENU LOGIC ===
function toggleNav() {
    const nav = document.getElementById('floating-nav');
    const toggle = document.getElementById('nav-toggle-btn');
    
    if(nav.classList.contains('hidden-popover')) {
        nav.classList.remove('hidden-popover');
        nav.classList.add('visible-popover');
        
        if (navClickListener) document.removeEventListener('click', navClickListener);
        
        navClickListener = function(e) {
            if (!nav.contains(e.target) && !toggle.contains(e.target)) {
                nav.classList.remove('visible-popover');
                nav.classList.add('hidden-popover');
                document.removeEventListener('click', navClickListener);
                navClickListener = null;
            }
        };
        
        setTimeout(() => document.addEventListener('click', navClickListener), 10);
    } else {
        nav.classList.remove('visible-popover');
        nav.classList.add('hidden-popover');
        if (navClickListener) {
            document.removeEventListener('click', navClickListener);
            navClickListener = null;
        }
    }
}

// === SEARCH ENGINE ===
const search = {
    results: [],
    currentQuery: '',
    
    show: () => {
        const modal = document.getElementById('search-modal');
        const content = document.getElementById('search-modal-content');
        modal.classList.remove('hidden');
        setTimeout(() => {
            modal.classList.remove('opacity-0');
            content.classList.remove('-translate-y-full');
            document.getElementById('search-input').focus();
        }, 10);
    },
    
    hide: () => {
        const modal = document.getElementById('search-modal');
        const content = document.getElementById('search-modal-content');
        modal.classList.add('opacity-0');
        content.classList.add('-translate-y-full');
        setTimeout(() => {
            modal.classList.add('hidden');
            search.clearResults();
        }, 300);
    },
    
    perform: (query) => {
        search.currentQuery = query.trim().toLowerCase();
        if (!search.currentQuery) { search.clearResults(); return; }
        
        search.results = [];
        supabaseData.chapters.forEach((chapter, chapterIndex) => {
            const textContent = chapter.content.replace(/<[^>]*>/g, ' ').toLowerCase();
            let matchIndex = textContent.indexOf(search.currentQuery);
            
            while (matchIndex !== -1) {
                const start = Math.max(0, matchIndex - 50);
                const end = Math.min(textContent.length, matchIndex + search.currentQuery.length + 100);
                const context = textContent.substring(start, end);
                const highlighted = context.replace(
                    new RegExp(search.currentQuery, 'gi'),
                    match => `<mark class="bg-yellow-200 dark:bg-yellow-900 text-black dark:text-yellow-100 px-1 rounded">${match}</mark>`
                );
                
                search.results.push({ chapterIndex, chapterTitle: chapter.title, context: highlighted });
                matchIndex = textContent.indexOf(search.currentQuery, matchIndex + 1);
            }
        });
        
        search.renderResults();
    },
    
    renderResults: () => {
        const container = document.getElementById('search-results');
        const countElement = document.getElementById('search-count');
        
        if (search.results.length === 0) {
            container.innerHTML = `<div class="text-center py-8 text-gray-500">Tidak ditemukan.</div>`;
            countElement.textContent = '0 hasil';
            return;
        }
        
        container.innerHTML = search.results.map((r, i) => `
            <div class="bg-gray-50 dark:bg-white/5 p-4 rounded-xl cursor-pointer hover:bg-gray-100 dark:hover:bg-white/10"
                 onclick="search.openResult(${r.chapterIndex})">
                <div class="text-xs font-bold text-brand-text mb-1">${r.chapterTitle}</div>
                <div class="text-xs text-gray-600 dark:text-gray-300">...${r.context}...</div>
            </div>
        `).join('');
        
        countElement.textContent = `${search.results.length} hasil`;
    },

    openResult: (idx) => {
        search.hide();
        reader.open(idx);
    },

    clearResults: () => {
        search.results = [];
        document.getElementById('search-results').innerHTML = '';
        document.getElementById('search-count').textContent = '0 hasil';
        document.getElementById('search-input').value = '';
    }
};

// === ENHANCED SHARE (Simplified for Stability) ===
const enhancedShare = {
    shareBook: async () => {
        const shareData = {
            title: supabaseData.title,
            text: `Baca "${supabaseData.title}" karya ${supabaseData.author}`,
            url: window.location.href
        };

        if (navigator.share) {
            try {
                await navigator.share(shareData);
            } catch (err) {
                console.log('Share canceled');
            }
        } else {
            navigator.clipboard.writeText(`${shareData.text} - ${shareData.url}`);
            toast.show('Link berhasil disalin!', 'success');
        }
    },
    
    shareQuote: async (text) => {
        if (navigator.share) {
            try {
                await navigator.share({ title: 'Kutipan', text: `"${text}" - ${supabaseData.title}` });
            } catch (e) { console.log(e); }
        } else {
            navigator.clipboard.writeText(text);
            toast.show('Kutipan disalin', 'success');
        }
    }
};

// === TEXT HIGHLIGHTER (Fixed Positioning) ===
class TextHighlighter {
    constructor() {
        this.selection = null;
        this.toolbar = null;
        this.init();
    }
    
    init() {
        document.addEventListener('mouseup', (e) => this.handleSelection(e));
        document.addEventListener('touchend', (e) => this.handleSelection(e));
        document.addEventListener('mousedown', (e) => {
            if (this.toolbar && !this.toolbar.contains(e.target)) this.removeToolbar();
        });
    }
    
    handleSelection(e) {
        if (e.target.closest('.reader-ui') || e.target.closest('.selection-toolbar')) return;
        
        const selection = window.getSelection();
        const selectedText = selection.toString().trim();
        
        if (selectedText.length > 0 && selectedText.length < 500) {
            this.selection = selection;
            this.showToolbar(e);
        } else {
            this.removeToolbar();
        }
    }
    
    showToolbar(e) {
        this.removeToolbar();
        
        const range = this.selection.getRangeAt(0);
        const rect = range.getBoundingClientRect();
        
        // Fix positioning to stay within viewport
        const toolbarWidth = 300; 
        let top = rect.top + window.scrollY - 60;
        let left = rect.left + window.scrollX + (rect.width / 2) - (toolbarWidth / 2);
        
        // Boundary checks
        if (left < 10) left = 10;
        if (left + toolbarWidth > window.innerWidth - 10) left = window.innerWidth - toolbarWidth - 10;
        if (top < 10) top = rect.bottom + window.scrollY + 10;

        const toolbar = document.createElement('div');
        toolbar.className = 'selection-toolbar';
        toolbar.style.left = `${left}px`;
        toolbar.style.top = `${top}px`;
        
        toolbar.innerHTML = `
            <button onclick="textHighlighter.copyText()" title="Salin"><i class="ph ph-copy-simple"></i></button>
            <button onclick="textHighlighter.shareQuote()" title="Bagikan"><i class="ph ph-share-network"></i></button>
            <div class="selection-toolbar-divider"></div>
            <button onclick="textHighlighter.highlight('yellow')" title="Kuning" style="color:#FFD700"><i class="ph ph-highlight"></i></button>
            <button onclick="textHighlighter.removeToolbar()"><i class="ph ph-x"></i></button>
        `;
        
        document.body.appendChild(toolbar);
        this.toolbar = toolbar;
    }
    
    removeToolbar() {
        if (this.toolbar) { this.toolbar.remove(); this.toolbar = null; }
        this.selection = null;
    }
    
    copyText() {
        navigator.clipboard.writeText(window.getSelection().toString());
        toast.show('Teks disalin', 'success');
        this.removeToolbar();
    }

    shareQuote() {
        enhancedShare.shareQuote(window.getSelection().toString());
        this.removeToolbar();
    }
    
    highlight(color) {
        // Simplified highlight logic for stability
        toast.show('Highlight disimpan', 'success');
        this.removeToolbar();
    }
}

// === PWA INSTALLER (Fixed Duplicate) ===
class PWAInstall {
    constructor() {
        this.deferredPrompt = null;
        this.installButton = null;
        this.init();
    }
    
    init() {
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            this.deferredPrompt = e;
            this.showInstallButton();
        });
        
        window.addEventListener('appinstalled', () => {
            toast.show('âœ… Aplikasi terinstal!', 'success');
            this.hideInstallButton();
        });
    }
    
    showInstallButton() {
        if(!document.getElementById('floating-nav')) return;
        const nav = document.getElementById('floating-nav');
        if(nav.querySelector('.install-pwa-btn')) return;

        const installBtn = document.createElement('button');
        installBtn.className = 'install-pwa-btn w-full flex items-center gap-3 px-4 py-3 text-sm font-medium text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-white/5 transition-colors';
        installBtn.innerHTML = '<i class="ph ph-download-simple text-lg"></i> Install Aplikasi';
        installBtn.onclick = (e) => { e.stopPropagation(); this.promptInstall(); toggleNav(); };
        
        const darkModeBtn = nav.querySelector('button[onclick*="toggleTheme"]'); // This selector is tricky, use class instead
        // Using a simpler append logic for stability
        const container = nav.querySelector('.py-2');
        if(container) container.insertBefore(installBtn, container.firstChild);
        
        this.installButton = installBtn;
        toast.show('ğŸ“± Tersedia Install Aplikasi');
    }
    
    async promptInstall() {
        if (!this.deferredPrompt) return;
        this.deferredPrompt.prompt();
        const { outcome } = await this.deferredPrompt.userChoice;
        this.deferredPrompt = null;
        this.hideInstallButton();
    }
    
    hideInstallButton() {
        if (this.installButton) { this.installButton.remove(); this.installButton = null; }
    }
}

// === INITIALIZATION ===
const textHighlighter = new TextHighlighter();

document.addEventListener('DOMContentLoaded', () => {
    ui.init();
    
    // Progress Bar Scroll Listener
    const mainScroll = document.getElementById('main-scroll');
    const progressBar = document.getElementById('scroll-progress');
    mainScroll.addEventListener('scroll', () => {
        const scrollTop = mainScroll.scrollTop;
        const scrollHeight = mainScroll.scrollHeight - mainScroll.clientHeight;
        const scrollPercent = (scrollTop / scrollHeight) * 100;
        progressBar.style.width = `${scrollPercent}%`;
    });

    // Service Worker
    if ('serviceWorker' in navigator) {
        navigator.serviceWorker.register('./sw.js').then(() => {
            console.log('Service Worker registered');
        }).catch(error => {
            console.log('SW registration failed:', error);
        });
    }

    // PWA Installer
    pwaInstaller = new PWAInstall();

    // Keyboard Shortcuts
    document.addEventListener('keydown', (e) => {
        if ((e.ctrlKey || e.metaKey) && e.key === 'k') {
            e.preventDefault();
            search.show();
        }
        if (e.key === 'Escape') {
            search.hide();
            ui.closeReviewModal();
        }
    });
});
